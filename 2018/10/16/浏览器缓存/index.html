
<!DOCTYPE html>
<html lang="zh-cn">
    
<head>
    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="SELF">
    <title>浏览器缓存 - SELF</title>
    <meta name="author" content="Bin Hong">
    
    
        <link rel="alternative" type="application/atom+xml" title="RSS" href="/atom.xml">
    
    <meta name="description" content="缓存面试中一个经常被问到的问题。首先缓存有很多种例如 CDN 缓存，数据库缓存，代理服务器缓存，浏览器缓存，这里主要说说浏览器缓存。 什么是浏览器缓存简单理解，主要指 http 的缓存——即协议层，应该是浏览器储存了的一些页面资源文件，例如 js，css，图片等等 浏览器缓存有哪些类别 强缓存 协商缓存  强缓存只有当缓存失效，才会去服务端获取新的资源，否则都使用本地缓存。与强缓存相关的属性  E">
<meta name="keywords" content="技术,总结">
<meta property="og:type" content="blog">
<meta property="og:title" content="浏览器缓存">
<meta property="og:url" content="http://hh-hb.com/2018/10/16/浏览器缓存/index.html">
<meta property="og:site_name" content="SELF">
<meta property="og:description" content="缓存面试中一个经常被问到的问题。首先缓存有很多种例如 CDN 缓存，数据库缓存，代理服务器缓存，浏览器缓存，这里主要说说浏览器缓存。 什么是浏览器缓存简单理解，主要指 http 的缓存——即协议层，应该是浏览器储存了的一些页面资源文件，例如 js，css，图片等等 浏览器缓存有哪些类别 强缓存 协商缓存  强缓存只有当缓存失效，才会去服务端获取新的资源，否则都使用本地缓存。与强缓存相关的属性  E">
<meta property="og:locale" content="zh-cn">
<meta property="og:updated_time" content="2023-05-18T14:50:49.380Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="浏览器缓存">
<meta name="twitter:description" content="缓存面试中一个经常被问到的问题。首先缓存有很多种例如 CDN 缓存，数据库缓存，代理服务器缓存，浏览器缓存，这里主要说说浏览器缓存。 什么是浏览器缓存简单理解，主要指 http 的缓存——即协议层，应该是浏览器储存了的一些页面资源文件，例如 js，css，图片等等 浏览器缓存有哪些类别 强缓存 协商缓存  强缓存只有当缓存失效，才会去服务端获取新的资源，否则都使用本地缓存。与强缓存相关的属性  E">
    
        <meta rel="publisher" content="https://plus.google.com/+hb342054368"/>
    
    
    
    
    
    
    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/style.min.css">
    <!--STYLES END-->
    
</head>

    <body>
        <div id="blog">
            <header id="header" data-behavior="3">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <h1 class="header-title">
        <a class="header-title-link" href="/ ">SELF</a>
    </h1>
    
</header>
            <nav id="sidebar" data-behavior="3">
    
    
        <ul class="sidebar-buttons">
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/ "
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-home"></i>
                    <span class="sidebar-button-desc">Home</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/all-categories"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
                    <span class="sidebar-button-desc">Categories</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/all-tags"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
                    <span class="sidebar-button-desc">Tags</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/all-archives"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
                    <span class="sidebar-button-desc">Archive</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link st-search-show-outputs"
                         href="#search"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-search"></i>
                    <span class="sidebar-button-desc">Search</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="#about"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-question"></i>
                    <span class="sidebar-button-desc">About</span>
                </a>
        </li>
        
    </ul>
    
        <ul class="sidebar-buttons">
        
    </ul>
    
        <ul class="sidebar-buttons">
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/atom.xml"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
                    <span class="sidebar-button-desc">RSS</span>
                </a>
        </li>
        
    </ul>
    
</nav>

            
            <div id="main" data-behavior="3"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post" itemscope itemType="http://schema.org/BlogPosting">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title" itemprop="headline">
            浏览器缓存
        </h1>
    
    <div class="post-meta">
    <time itemprop="datePublished" content="Tue Oct 16 2018 01:29:02 GMT+0000">
	
		    10月 16, 2018
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/技术/">技术</a>


    
</div>
</div>
    
    <div class="post-content markdown" itemprop="articleBody">
        <div class="main-content-wrap">
            <h3 id="缓存"><a href="#缓存" class="headerlink" title="缓存"></a>缓存</h3><p>面试中一个经常被问到的问题。首先缓存有很多种例如 CDN 缓存，数据库缓存，代理服务器缓存，浏览器缓存，这里主要说说<strong>浏览器缓存</strong>。</p>
<h3 id="什么是浏览器缓存"><a href="#什么是浏览器缓存" class="headerlink" title="什么是浏览器缓存"></a>什么是浏览器缓存</h3><p>简单理解，主要指 http 的缓存——即协议层，应该是浏览器储存了的一些页面资源文件，例如 js，css，图片等等</p>
<h3 id="浏览器缓存有哪些类别"><a href="#浏览器缓存有哪些类别" class="headerlink" title="浏览器缓存有哪些类别"></a>浏览器缓存有哪些类别</h3><ul>
<li>强缓存</li>
<li>协商缓存</li>
</ul>
<h3 id="强缓存"><a href="#强缓存" class="headerlink" title="强缓存"></a>强缓存</h3><p>只有当缓存失效，才会去服务端获取新的资源，否则都使用本地缓存。<br>与强缓存相关的属性</p>
<ul>
<li>Expries (http/1.0)</li>
<li>Cache-Control (http/1.1)</li>
</ul>
<blockquote>
<p>Expires: Thu, 10 Nov 2017 08:45:11 GMT</p>
</blockquote>
<blockquote>
<p>Cache-Control: max-age=2592000</p>
</blockquote>
<p>Expires 是一个绝对时间，但是如果客户端更改了时间，则会导致计算偏差，从而导致缓存失效。</p>
<p>Cache-Control 是一个相对时间，表示资源缓存的最大有效时间，在该时间内不需要向服务端发起请求。同时 Cache-Control 能够设置的力度比较细腻。其能够带的值有下面一些：</p>
<ul>
<li>max-age：即最大有效时间，在上面的例子中我们可以看到</li>
<li>no-cache：表示没有缓存，即告诉浏览器该资源并没有设置缓存</li>
<li>s-maxage：同 max-age，但是仅用于共享缓存，如 CDN 缓存</li>
<li>public：多用户共享缓存，默认设置</li>
<li>private：不能够多用户共享，HTTP 认证之后，字段会自动转换成 private。</li>
</ul>
<h3 id="协商缓存"><a href="#协商缓存" class="headerlink" title="协商缓存"></a>协商缓存</h3><p>客户端会发起一次请求查询缓存是否过期，如果没有，服务端则返回 304，客户端使用本地缓存，否则服务端直接返回数据。<br>与协商缓存相关的属性</p>
<ul>
<li>response header: Last-Modified</li>
<li>request header: If-Modified-Since</li>
<li>response header: Etag</li>
<li>request header: If-None-Match</li>
</ul>
<blockquote>
<p>Last-Modified: Thu, 10 Nov 2015 08:45:11 GMT</p>
</blockquote>
<blockquote>
<p>ETag: W/*5954f167-63c6</p>
</blockquote>
<p>Last-Modified 是服务端返回在 response header 中的一个属性，再次请求的时候，客户端会使用 If-Modified-Since 并带上之前的 Last-Modified 的值，服务端则会将 If-Modified-Since 和 Last-Modified 对比，如果相等，则表示没有修改，返回 304，反之则表示修改了，返回 200 状态码和数据。</p>
<p>ETag 是储存文件的特殊标识，因为 Last-Modified 的缺陷，只能精确到秒级，所以如果在一秒内资源文件多次改变，则 Last-Modified 会失效。ETag 也是服务端返回在 response header 中的一个属性，再次请求的时候，客户端会使用 If-None-Match 并带上之前的 ETag 的值，服务端会将 If-None-Match 和 Etag 进行比较，如果相等表示没有修改，返回 304，反制表示修改了，返回 200 状态码和数据。</p>
<blockquote>
<p>Last-Modified 与 ETag 是可以一起使用的，服务器会优先验证 ETag，一致的情况下，才会继续比对 Last-Modified，最后才决定是否返回 304 或者 200</p>
</blockquote>
<p>下面有个表格可以直观的看到 http 中和缓存相关的属性</p>
<table>
<thead>
<tr>
<th>属性名</th>
<th style="text-align:center">值/示例</th>
<th style="text-align:center">类型</th>
<th style="text-align:center">作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>Pragma</td>
<td style="text-align:center">no-cache</td>
<td style="text-align:center">Response</td>
<td style="text-align:center">告诉浏览器忽略资源的缓存副本，每次访问都需要去服务器拉取【http1.0中存在的字段，在http1.1已被抛弃，使用Cache-Control替代，但为了做http协议的向下兼容，很多网站依旧会带上这个字段】</td>
</tr>
<tr>
<td>Expires</td>
<td style="text-align:center">Mon, 15 Aug 2016 03:56:47 GMT</td>
<td style="text-align:center">Response</td>
<td style="text-align:center">启用缓存和定义缓存时间。告诉浏览器资源缓存过期时间，如果还没过该时间点则不发请求【http1.0中存在的字段，该字段所定义的缓存时间是相对服务器上的时间而言的，如果客户端上的时间跟服务器上的时间不一致（特别是用户修改了自己电脑的系统时间），那缓存时间可能就没啥意义了。在HTTP 1.1版开始，使用Cache-Control: max-age=秒替代】</td>
</tr>
<tr>
<td>Cache-Control</td>
<td style="text-align:center">no-cache</td>
<td style="text-align:center">Response</td>
<td style="text-align:center">告诉浏览器忽略资源的缓存副本，强制每次请求直接发送给服务器，拉取资源，但不是“不缓存”</td>
</tr>
<tr>
<td></td>
<td style="text-align:center">no-store</td>
<td style="text-align:center">Response</td>
<td style="text-align:center">强制缓存在任何情况下都不要保留任何副本</td>
</tr>
<tr>
<td></td>
<td style="text-align:center">max-age</td>
<td style="text-align:center">Response</td>
<td style="text-align:center">指明缓存副本的有效时长，从请求时间开始到过期时间之间的秒数</td>
</tr>
<tr>
<td></td>
<td style="text-align:center">public</td>
<td style="text-align:center">Response</td>
<td style="text-align:center">任何路径的缓存者（本地缓存、代理服务器），可以无条件的缓存改资源</td>
</tr>
<tr>
<td></td>
<td style="text-align:center">private</td>
<td style="text-align:center">Response</td>
<td style="text-align:center">只针对单个用户或者实体（不同用户、窗口）缓存资源</td>
</tr>
<tr>
<td>Last-Modified</td>
<td style="text-align:center">Mon, 15 Aug 2016 03:56:47 GMT</td>
<td style="text-align:center">Response</td>
<td style="text-align:center">告诉浏览器这个资源最后的修改时间。服务器将资源传递给客户端时，会将资源最后更改的时间以“Last-Modified: GMT”的形式加在实体首部上一起返回给客户端【只能精确到秒级，如果某些文件在1秒钟以内，被修改多次的话，它将不能准确标注文件的修改时间】</td>
</tr>
<tr>
<td>If-Modified-Since</td>
<td style="text-align:center">Mon, 15 Aug 2016 03:56:47 GMT</td>
<td style="text-align:center">Request</td>
<td style="text-align:center">其值为上次响应头的Last-Modified值，再次向web服务器请求时带上头If-Modified-Since。web服务器收到请求后发现有头If-Modified-Since则与被请求资源的最后修改时间进行比对。若最后修改时间较新，说明资源又被改动过，则响应整片资源内容（写在响应消息包体内），包括更新Last-Modified的值，HTTP 200；若最后修改时间较旧，说明资源无新修改，则响应HTTP 304(无需包体，节省浏览)，告知浏览器继续使用所保存的cache</td>
</tr>
<tr>
<td>ETag</td>
<td style="text-align:center">fd56273325a2114818df4f29a628226d</td>
<td style="text-align:center">Response</td>
<td style="text-align:center">告诉浏览器当前资源在服务器的唯一标识符（生成规则又服务器决定）</td>
</tr>
<tr>
<td>If-None-Match</td>
<td style="text-align:center">fd56273325a2114818df4f29a628226d</td>
<td style="text-align:center">Request</td>
<td style="text-align:center">当资源过期时（使用Cache-Control标识的max-age），发现资源具有Etage声明，则再次向web服务器请求时带上头If-None-Match（Etag的值）。web服务器收到请求后发现有头If-None-Match则与被请求资源的相应校验串进行比对，决定返回200或304</td>
</tr>
</tbody>
</table>
<h3 id="不能缓存的请求"><a href="#不能缓存的请求" class="headerlink" title="不能缓存的请求"></a>不能缓存的请求</h3><ul>
<li>HTTP信息头中包含Cache-Control:no-cache，pragma:no-cache（HTTP1.0），或Cache-Control:max-age=0等告诉浏览器不用缓存的请求</li>
<li>需要根据Cookie，认证信息等决定输入内容的动态请求是不能被缓存的</li>
<li>经过HTTPS安全加密的请求</li>
<li>POST请求无法被缓存</li>
<li>HTTP响应头中不包含Last-Modified/Etag，也不包含Cache-Control/Expires的请求无法被缓存</li>
</ul>

            
                

            
        </div>
    </div>
    <div class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br/>
                
    <a class="tag tag--primary tag--small t-link" href="/tags/总结/">总结</a> <a class="tag tag--primary tag--small t-link" href="/tags/技术/">技术</a>

            </div>
        
        <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--disabled">
                
                    <i class="fa fa-angle-left"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                </a>
            </li>
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2018/09/10/JAVASCRIPT中的call-apply-bind/" data-tooltip="JAVASCRIPT 中的 call,apply,bind">
                
                    <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                    <i class="fa fa-angle-right"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions"  href="#btn-open-shareoptions">
                <i class="fa fa-share-alt"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=http://hh-hb.com/2018/10/16/浏览器缓存/">
                <i class="fa fa-google-plus"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://hh-hb.com/2018/10/16/浏览器缓存/">
                <i class="fa fa-facebook-official"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=http://hh-hb.com/2018/10/16/浏览器缓存/">
                <i class="fa fa-twitter"></i>
            </a>
        </li>
        
            <li class="post-action">
                <a class="post-action-btn btn btn--default" href="#disqus_thread">
                    <i class="fa fa-comment-o"></i>
                </a>
            </li>
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#">
            
                <i class="fa fa-list"></i>
            </a>
        </li>
    </ul>
</div>


        
            <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2023 Bin Hong. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="3">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--disabled">
                
                    <i class="fa fa-angle-left"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                </a>
            </li>
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2018/09/10/JAVASCRIPT中的call-apply-bind/" data-tooltip="JAVASCRIPT 中的 call,apply,bind">
                
                    <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                    <i class="fa fa-angle-right"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions"  href="#btn-open-shareoptions">
                <i class="fa fa-share-alt"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=http://hh-hb.com/2018/10/16/浏览器缓存/">
                <i class="fa fa-google-plus"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://hh-hb.com/2018/10/16/浏览器缓存/">
                <i class="fa fa-facebook-official"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=http://hh-hb.com/2018/10/16/浏览器缓存/">
                <i class="fa fa-twitter"></i>
            </a>
        </li>
        
            <li class="post-action">
                <a class="post-action-btn btn btn--default" href="#disqus_thread">
                    <i class="fa fa-comment-o"></i>
                </a>
            </li>
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#">
            
                <i class="fa fa-list"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                <div id="share-options-bar" class="share-options-bar" data-behavior="3">
    <ul class="share-options">
        <li class="share-option">
            <a class="share-option-btn" target="new" href="https://plus.google.com/share?url=http://hh-hb.com/2018/10/16/浏览器缓存/">
                <i class="fa fa-google-plus"></i><span class="">Share on Google Plus</span>
            </a>
        </li>
        <li class="share-option">
            <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://hh-hb.com/2018/10/16/浏览器缓存/">
                <i class="fa fa-facebook-official"></i><span>Share on Facebook</span>
            </a>
        </li>
        <li class="share-option">
            <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=http://hh-hb.com/2018/10/16/浏览器缓存/">
                <i class="fa fa-twitter"></i><span>Share on Twitter</span>
            </a>
        </li>
    </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>
            
        </div>
        <div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-remove"></i>
        </div>
        
            <h4 id="about-card-name">Bin Hong</h4>
        
            <h5 id="about-card-bio"><p>author.bio</p>
</h5>
        
        
            <h5 id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>author.job</p>

            </h5>
        
        
            <h5 id="about-card-location">
                <i class="fa fa-map-marker"></i>
                <br/>
                Guang Zhou Guang Dong China
            </h5>
        
    </div>
</div>

        <div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
    </body>
    <!--SCRIPTS-->
<script src="/assets/js/script.min.js"></script>
<!--SCRIPTS END-->

    <script type="text/javascript">
        var disqus_shortname = 'myselfverten';
        (function() {
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>



</html>
